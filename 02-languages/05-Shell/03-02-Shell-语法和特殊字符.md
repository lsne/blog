# Shell 特殊字符

## 常见特殊字符

| 序号  | 符号   | 作用                                                   | 示例                              |
| --- | ---- | ---------------------------------------------------- | ------------------------------- |
| 1   | `$0` | 当前脚本的名称                                              |                                 |
| 2   | `$#` | 传递给脚本或函数的参数个数                                        |                                 |
| 3   | `$*` | 传递给脚本或函数的所有参数                                        |                                 |
| 4   | `$@` | 传递给脚本或函数的所有参数。被双引号 `""` 包含时，与 `$*` 稍有不同，下面将会讲到       |                                 |
| 5   | `$?` | 上个命令的退出状态，或函数的返回值。                                   |                                 |
| 6   | `$$` | 当前Shell进程ID。对于 Shell 脚本，就是这些脚本所在的进程ID。               |                                 |
| 7   | `$n` | 传递给脚本或函数的参数。n 是一个数字，表示第几个参数，第一个参数是 `$1`，第二个参数是 `$2`。 |                                 |
| 8   | `*`  | 作为匹配文件名扩展的一个通配符，能自动匹配给定目录下的每一个文件。                    |                                 |
| 9   | `~`  | 波浪号。和环境变量 $HOME 一样。默认表示当前用户的家目录                      | `echo ~` 查看家目录                  |
| 10  | `--` | 两个减号，与 `~` 相同，表示当前用户的家目录                             | `cd - -` 回到家目录，但不能 `echo --` 输出 |
| 11  | `~+` | 当前工作目录。和环境变量 $PWD 一样。                                | `echo ~+` 可以查看当前目录              |
| 12  | `~-` | 前一个工作目录。和内部变量 $OLDPWD 一致，和减号一样。                      | `echo ~-` 可以查看前一个工作目录           |
| 13  | `-`  | 减号 `-` 和 `~-` 一样，表示前一个工作目录。                          | `cd -` 回到前一个工作目录，但不能 echo - 来查看 |
| 14  | `.`  | 点号 `.` 表示当前目录                                        | `ls .` 查看当前目录内容                 |
| 15  | `..` | 两个点号 `..` 表示上一层目录                                    | `ls ..` 查看上一层目录内容               |

## 变量替换符

| 序号  | 符号        | 作用                                                                                                                                                            | 示例                                                               |
| --- | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| 1   | `$`       | 美元符放在变量前用于取变量的值                                                                                                                                               | `echo $PATH` 打印环境变量 PATH 的值                                      |
| 2   | `${}`     | 美元符加上大括号，大括号中放变量的名称，也是用于读取变量的值                                                                                                                                | `echo ${PATH}path`,访问变量PATH，而不是变量 PATHpath，注意和上面 $ 的区别           |
| 3   | `${:-}`   | 用法`${var:-word}`。表示如果变量 var 为空或已被删除(unset)，那么返回 word，但不改变 var 的值。                                                                                             |                                                                  |
| 4   | `${:+}`   | 用法`${var:+word}`。如果变量 var 被定义，那么返回 word，但不改变 var 的值。                                                                                                          |                                                                  |
| 5   | `${:=}`   | 用法`${var:=word}`。如果变量 var 为空或已被删除(unset)，那么返回 word，并将 var 的值设置为 word。                                                                                         |                                                                  |
| 6   | `${:?}`   | 用法`${var:?message}`。如果变量 var 为空或已被删除（unset），那么将消息 message 送到标准错误输出，可以用来检测变量 var 是否可以被正常赋值。若此替换出现在Shell脚本中，那么脚本将停止运行。                                          |                                                                  |
| 7   | `${#}`    | 用法`${#var}`。获取字符串变量 var 的长度                                                                                                                                   | `string="abcd"; echo ${#string}` 输出 4                            |
| 8   | `${:}`    | 字符串提取，用法${var:n}。若n为正数，n从0开始，表示在变量var中提取第n个字符到末尾的所有字符。若n为负数，提取字符串最后面n的绝对值个字符，使用时在冒号后面加空格或一个算术表达式或整个num加上括号，如${var: -2}、${var:1−3}或 ${var:(-2)}均表示提取字符串最后两个字符。 | `a="abcde";echo ${a:1-4}`输出 cde。                                 |
| 9   | `${::}`   | 字符串提取，用法${var:n1:n2}。                                                                                                                                         | `string="tencent is a great company";echo ${string:1:4}`输出 ence。 |
| 10  | `{,}`     | 顺序扩展，用法`${value1,value2,value3}`，逗号分隔一般用于文件列表的扩展。                                                                                                             | `echo {a,b}.txt`输出 a.txt b.txt。                                  |
| 11  | `{..}`    | 顺序扩展，用法`${value1..value2}`，双点号分隔一般用于文件列表的扩展。                                                                                                                  | `echo {a..d}.txt`输出 a.txt b.txt c.txt d.txt                      |
| 12  | `${#}`    | 模式匹配截断，不改变原变量。用法`${var#pattern}`，在 var 中查找给定的模式 pattern，把 var 中的内容去掉左边最短的匹配模式。                                                                                | `var=testcase; echo ${var#*s}`输出 tcase。                          |
| 13  | `${##}`   | 模式匹配截断，不改变原变量。用法`${var##pattern}`，在 var 中查找给定的模式 pattern，把 var 中的内容去掉左边最长的匹配模式。                                                                               | `var=testcase; echo ${var##*s}` 输出 e。                            |
| 14  | `${%}`    | 模式匹配截断，不改变原变量。用法`${var%pattern}`，在 var 中查找给定的模式 pattern，把 var 中的内容去掉右边最短的匹配模式。                                                                                | `var=testcase;echo ${var%s*e} `输出 testca。                        |
| 15  | `${%%}`   | 模式匹配截断，不改变原变量。用法`${var%%pattern}`，在 var 中查找，把 variable 中的内容去掉右边最长的匹配模式。                                                                                       | `var=testcase;echo ${var%%s*e}`输出 te。                            |
| 16  | `${/ /}`  | 模式匹配替换，不改变原变量。用法`${var/pattern/pattern}`将 var 字符串的第一个匹配的 pattern 替换为另一个 pattern。                                                                              | `var=/home/centos;echo ${var/o/h}`输出 /hhme/centos                |
| 17  | `${// /}` | 模式匹配替换，不改变原变量。用法`${var//pattern/pattern}`表示将 var 字符串中的所有能匹配的 pattern 替换为另一个pattern。                                                                           | `var=/home/centos;echo ${var//o/h}`输出 /hhme/cenths。              |
| 18  | `$[]`     | 整数扩展，在方括号内执行整数表达式并返回结果。                                                                                                                                       | `a=3;b=7;echo $[$a+$b]`输出 10                                     |

## 语法功能符

| 序号  | 符号    | 作用                                                                                                                                                                           | 示例                                                                       |
| --- | ----- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------ |
| 1   | `#`   | 井号。在 Shell 文件首行，用于指定执行该脚本的解释器，其他地方用于单行注释。                                                                                                                                    | 脚本首行#!/bin/bash指明脚本解释器为 Bash。                                            |
| 2   | `;`   | 分号。语句的分隔符。脚本一行写多条语句时，使用分号分隔。                                                                                                                                                 |                                                                          |
| 3   | `;;`  | 双分号。在使用 case 选项时，作为每个选项的终结符。在 Bash version 4+ 的时候，还可以使用`[;;&]`或 `[;&]`                                                                                                       |                                                                          |
| 4   | `/`   | 斜杠。路径的分隔符，路径中仅有一个斜杆表示根目录，以斜杆开头的路径表示从根目录开始的路径。                                                                                                                                |                                                                          |
| 5   | `\|`  | 管道。管道是类 Unix 系统都有的概念，是非常基础、非常重要的一个概念。它的作用是将管道前（左边）命令产生的标准输出（stdout）作为管道后（右边）命令的标准输入（stdin）。注意，对于标准错误输出（stderr）无效。                                                            | `less file \| wc -l` 用于统计文件的行数                                           |
| 6   | `>`   | 标准输出重定向符。注意，对于标准错误输出无效。                                                                                                                                                      | `echo lvlv>file`，将标准输出重定向到文件，如果文件存在则覆盖，不存在则创建。不指定输出的内容，>file，则清空文件。      |
| 7   | `>>`  | 标准输出重定向追加符。                                                                                                                                                                  | `echo lvlv 1>>file`,将标准输出重定向文件file的最后面，不会覆盖file原有内容                      |
| 8   | `>&`  | 输出重定向等同符，作用于文件描述符，即左右两边的操作数是文件描述符                                                                                                                                            | `echo lvlv>file 2>&1`,标准输出重定向到文件file中，标准错误输出与标准输出重定向一致                   |
| 9   | `&>`  | 标准输出和标准错误输出重定向符。                                                                                                                                                             | `echo lvlv &>file`,标准输出和标准错误输出都重定向到文件file中，与`echo lvlv 1>file 2>&1` 功能相同 |
| 10  | `<`   | 输入重定向                                                                                                                                                                        | `test.sh < file`,脚本test.sh需要read的地方会从文件file读取                            |
| 11  | `<<`  | 名为 Here Document。用法格式 cmd << text。作用将后继内容重定向到左侧命令的 stdin 中。内容直到与 text 相同的行结束。除非使用引号把输入括起来，此模式将对输入内容进行 Shell 变量替换。如果使用 <<- ，则会忽略接下来输入行首的 tab，结束行也可以是一堆 tab 再加上一个与 text 相同的内容。 |                                                                          |
| 12  | `<&`  | 标准输入重定向等同符，作用于文件描述符，即左右两边的操作数是文件描述符                                                                                                                                          | `cmd <& m`,将文件描述符m作为cmd的输入，省略了标准输入描述符1，即等价于`cmd 1<&fd`                   |
| 13  | `>&-` | 关闭某个输出文件描述符。用法格式：`exec fd>&-`                                                                                                                                                | `exec >&-`或`exec 0>&-`，关闭标准输出                                            |
| 14  | `<&-` | 关闭某个输入文件描述符。用法格式：`exec fd>&-`                                                                                                                                                | `exec <&-`或`exec 1<&-`关闭标准输入                                             |
| 15  | `&`   | 与号。如果命令后面跟上一个&符号，这个命令将会在后台运行。                                                                                                                                                | 使用格式：`command &`                                                         |
| 16  | `/`   | 斜杠。主要有两种作用。<br>（1）作为路径的分隔符，路径中仅有一个斜杆表示根目录，以斜杆开头的路径表示从根目录开始的路径；<br> （2）在作为运算符的时候，表示除法符号。                                                                                      |                                                                          |
| 17  | `()`  | 一对小括号。主要有两种用法：<br> （1）命令组。括号中的命令将会新开一个子shell顺序执行，所以括号中的变量不能够被脚本余下的部分使用。括号中多个命令之间用分号隔开，最后一个命令可以没有分号，各命令和括号之间不必有空格。<br>（2）用于初始化数组。如 array=(a b c d)                            |                                                                          |
| 18  | `{}`  | 一对大括号。代码块标识符，一般用于函数定义时表明函数体。                                                                                                                                                 |                                                                          |
| 19  | `<<<` | 三个小于号。作用就是将后面的内容作为前面命令的标准输入。                                                                                                                                                 | `grep a <<< "$VARIABLE"`，意思就是在 VARIABLE 这个变量值里查找字符 a。                    |
| 20  | `>\|` | 大于号与竖杠。功能同 >，但即便设置了 noclobber 属性时也会强制复盖file文件。shell设置了noclobber属性表明已存在的文件不能被重定向输出覆盖。                                                                                         |                                                                          |
| 21  | `<>`  | 标准输入与输出重定向运算符                                                                                                                                                                | `exec 6<>filename`，通过 exec 命令，以读写的方式将文件描述符 6 绑定到指定文件。                    |

## 关系运算符

| 序号  | 符号     | 作用                                       | 示例                                                        |
| --- | ------ | ---------------------------------------- | --------------------------------------------------------- |
| 10  | `[]`   | 一对方括号，用于判断条件是否成立                         | `[ $a == $b ]`，注意添加 4 个空格                                 |
| 11  | `[[]]` | 两对方括号，是对` []` 的扩展，可使用 `<、>、&&、\|\|` 等运算符 | `[[ $a>$b ]]`，只需要添加左右两边两个空格。注意：使用 `==` 与` !=` 时，仍需要 4 个空格 |
| 12  | `-eq`  | 检测两个数是否相等，相等返回 true                      | `[ $a -eq $b ]` 返回 true                                   |
| 13  | `==`   | 检测两个数是否相等，作用同-eq                         | `[ $a == $b ]`返回 true                                     |
| 14  | `-ne`  | 检测两个数是否相等，不相等返回 true                     | `[ $a -ne $b ]` 返回 true                                   |
| 15  | `!=`   | 作用同 `-ne	[ $a != $b ]` 返回 true           |                                                           |
| 16  | `-gt`  | 检测左边的数是否大于右边的，如果是，则返回 true               | `[ $a -gt $b ]` 返回 false                                  |
| 17  | `-lt`  | 检测左边的数是否小于右边的，如果是，则返回 true               | `[ $a -lt $b ]` 返回 true                                   |
| 18  | `-ge`  | 检测左边的数是否大等于右边的，如果是，则返回 true              | `[ $a -ge $b ]` 返回 false                                  |
| 19  | `-le`  | 检测左边的数是否小于等于右边的，如果是，则返回 true             | `[ $a -le $b ]` 返回 true                                   |

## 逻辑运算符

| 序号  | 符号     | 作用                                                                                                                                                          | 示例                                     |
| --- | ------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| 20  | `!`    | 非运算，表达式为 true 则返回 false，否则返回 true。                                                                                                                          | `[ ! false ]` 返回 true                  |
| 21  | `-o`   | 或运算，有一个表达式为 true 则返回 true。                                                                                                                                  | `[ $a -lt 20 -o $b -gt 100 ]`返回 true   |
| 22  | `-a`   | 与运算，两个表达式都为 true 才返回 true。                                                                                                                                  | `[ $a -lt 20 -a $b -gt 100 ]` 返回 false |
| 23  | `\|\|` | 或运算符，与 `&&` 作用相反，也有两种用法。<br> （1）用于条件判断，需与 `[[]]` 配合使用。两个表达式有一个为 true 就返回 true。<br> （2）命令连接：command1 `\|\|` command2，左边的命令返回 false（即返回非 0，执行失败），右边的命令才能够被执行。 | `[[ $a < 20 \|\| $a > 19 ]]` 返回 true   |
| 24  | `&&`   | 与运算符，有两种用法。 <br> （1）用于条件判断，需与 `[[]]` 配合使用。两个表达式都为true才返回true。 <br> （2）命令连接。command1 && command2。左边的命令返回真（即返回 0，成功被执行），右边的命令才能够被执行。                          | `[[ $a < 20 && $a > 20 ]]` 返回 false    |
## 字符串运算符

| 序号  | 符号    | 作用                               | 示例                                               |
| --- | ----- | -------------------------------- | ------------------------------------------------ |
| 25  | `=`   | 检测两个字符串是否相等，相等返回 true            | `[ "$a" = "$b" ]` 返回 false                       |
| 26  | `!=`  | 检测两个字符串是否相等，不相等返回 true。          | `[ "$a" != "$b" ]` 返回 true                       |
| 27  | `-z`  | 检测字符串长度是否为 0，为 0 返回 true。        | `[ -z "$a" ]` 返回 false                           |
| 28  | `-n`  | 检测字符串长度是否为 0，不为 0 返回 true。       | `[ -n "$a" ]` 返回 true                            |
| 29  | `str` | 检测字符串是否为空，不为空返回 true。            | `[ "$a" ]` 返回 true                               |
| 30  | `=~`  | 正则表达式匹配运算符，用于匹配正则表达式的，配合 [[]] 使用 | `[[ ! $file =~ check$ ]]` 判断 $file 是否是以 check 结尾 |


## 文件运算符

| 序号  | 符号    | 作用                                | 示例                                             |
| --- | ----- | --------------------------------- | ---------------------------------------------- |
| 31  | `-b`  | 文件存在且是块设备文件                       | `[ -b /dev/vda1 ]` 返回 true                     |
| 32  | `-c`  | 文件存在且是字符设备文件                      | `[ -c /dev/stdin ]` 返回 true                    |
| 33  | `-d`  | 文件存在且是目录                          | `[ -d / ]` 返回 true                             |
| 34  | `-e`  | 文件（包括目录）是否存在                      | `[ -e / ]` 返回 true                             |
| 35  | `-f`  | 文件存在且是普通文件（既不是目录，也不是设备文件）         | `[ -f /etc/passwd]` 返回 true                    |
| 36  | `-g`  | 文件存在且设置了 SGID 位                   | `[ -g /usr/bin/passwd ]` 返回 false              |
| 37  | `-G`  | 文件存在且属于有效组 ID                     | `[ -G /etc/passwd ]` 返回 true                   |
| 38  | `-h`  | 文件存在且是软链接。同 -L                    | `[ -h /etc/passwd ]` 返回 false                  |
| 39  | `-k`  | 文件存在且设置了粘着位（Sticky Bit）           | `[ -k /tmp ]` 返回 true                          |
| 40  | `-L`  | 文件存在且是软链接。同 -h                    | `[ -L /etc/passwd ]` 返回 false                  |
| 41  | `-O`  | 文件存在且属于有效用户ID                     | `[ -O /etc/passwd ]` 返回 true                   |
| 42  | `-p`  | 文件存在且是具名管道                        | `[ -p /etc/passwd ]` 返回 false                  |
| 43  | `-r`  | 文件存在且可读                           | `[ -r /etc/passwd ]` 返回 true                   |
| 44  | `-s`  | 文件存在且不为空                          | `[ -s /etc/passwd ]` 返回 true                   |
| 45  | `-S`  | 文件存在且是套接字（socket）                 | `[ -s /etc/passwd ]` 返回 false                  |
| 46  | `-u`  | 文件存在且设置了 SUID 位                   | `[ -s /usr/bin/passwd ]` 返回 true               |
| 47  | `-w`  | 文件存在且可写                           | `[ -w /etc/shadow ]` 返回 false                  |
| 48  | `-x`  | 文件存在且可执行                          | `[ -x /usr/bin/passwd ]` 返回 true               |
| 49  | `-ef` | 两个文件是否为同一个文件。主要看文件设备号与 inode 是否一致 | `[ /usr/bin/passwd -ef /etc/passwd ]` 返回 false |
| 50  | `-nt` | 文件 FILE1 是否比 FILE2 新（修改时间新）       | `[ /usr/bin/passwd -nt /etc/passwd ]`返回 false  |
| 51  | `-ot` | 文件 FILE1 是否比 FILE2 旧（修改时间旧）       | `[ /usr/bin/passwd -ot /etc/passwd ]` 返回 true  |

## 文件类型

```
- 普通文件
d 目录
b 块设备
c 字符设备
p 命名管道
l 符号链接
s 套接字
```